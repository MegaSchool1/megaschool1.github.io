@page "/"
@using MegaSchool1.Components
@using MegaSchool1.Model
@using MegaSchool1.Model.Repository
@using MegaSchool1.Model.UI
@using MegaSchool1.Repository.Model
@using Content = MegaSchool1.Model.Content
@inherits Components.ComponentBase
@inject Constants Constants
@inject UISettings UI
@inject NavigationManager NavigationManager
@inject Repository.Repository Repo

<MudStack Spacing="3">
    <Collapsable Title="Essentials" ExpandPrompt="Show">
        <StrategyChooser>
            <MudTabPanel Tag="@Strategy.MegaSchool">
                <Loader Loaded="@(_megaSchoolEssentials.TeamMember != null)">
                    <TeamMemberPicker Description="Capture Page For:" User="AppState?.User" @bind-SelectedTeamMember="_megaSchoolEssentials.TeamMember">
                        <MudSelect T="Content" Label="Capture Page" @bind-Value="_megaSchoolEssentials.Content" ToStringFunc="@(content => (UI.EnglishLocale[content]?.AppTitle ?? content.ToString()).Replace("<br/>", " "))" Variant="Variant.Outlined" Style="width:300px;">
                            @foreach (var content in new Content[] { Content.GivBux, Content.EDMGivBux, Content.GivBuxOpportunity, Content.GivBuxCharity, Content.GivBuxMerchant })
                            {
                                <MudSelectItem Value="@content" />
                            }
                        </MudSelect>
                        <CapturePage Content="_megaSchoolEssentials.Content" TeamMember="_megaSchoolEssentials.TeamMember" />
                    </TeamMemberPicker>
                </Loader>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.Corporate">
                <MudStack>
                    <ShareableVideoMultilingual Description="@Constants.MoneyChallenge[Strategy.Corporate].Description"
                                                Duration="@Constants.MoneyChallenge[Strategy.Corporate].Duration"
                                                Url="@Constants.MoneyChallenge[Strategy.Corporate].PreviewUrl"

                                                EnglishTextToCopy="@(Constants.MoneyChallenge[Strategy.Corporate].English.Message)"
                                                EnglishTooltip="@(Constants.MoneyChallenge[Strategy.Corporate].English.Tooltip)"
                                                EnglishImageUrl="@(Constants.MoneyChallenge[Strategy.Corporate].ImageUrl)"

                                                SpanishTextToCopy="@(Constants.MoneyChallenge[Strategy.Corporate].Spanish!.Message)"
                                                SpanishTooltip="@(Constants.MoneyChallenge[Strategy.Corporate].Spanish!.Tooltip)"
                                                SpanishImageUrl="@(Constants.MoneyChallenge[Strategy.Corporate].ImageUrl)"/>
                    <ShareableVideo Description=@($"Next Level Strategies")
                                    Duration="new(0, 4, 0)"
                                    Url="@(UI.EnglishLocale[Model.Content.NextLevelStrategies]!.MinimalistUrl())"
                                    Tooltip="Shareable copied!"
                                    TextToCopy="@(Shareable.VideoShareable("MWR Next Level Strategies", UI.EnglishLocale[Content.NextLevelStrategies]!.MinimalistUrl(), new(0, 4, 0)))"
                                    ImageUrl="@(Constants.GetImageUrl(Image.NextLevelStrategies))"/>
                    <ShareableVideoMultilingual Description="@($"MWR Opportunity")"
                                                Duration="new(0, 5, 0)"
                                                Url="@(UI.EnglishLocale[Model.Content.CorporateBusinessOverview]!.MinimalistUrl())"

                                                EnglishTextToCopy="@Shareable.VideoShareable("MWR Opportunity", UI.EnglishLocale[Model.Content.CorporateBusinessOverview]!.MinimalistUrl(), new(0, 0, 5, 0))"
                                                EnglishTooltip="English shareable copied!"
                                                EnglishImageUrl="@Constants.GetImageUrl(Image.MoneyChallengeLogo)"

                                                SpanishTextToCopy="@Shareable.VideoShareable("MWR Opportunity", UI.SpanishLocale[Model.Content.CorporateBusinessOverview]!.MinimalistUrl(), new(0, 0, 6, 0))"
                                                SpanishTooltip="Español shareable copied!"
                                                SpanishImageUrl="@Constants.GetImageUrl(Image.MoneyChallengeLogo)"/>
                    @ContentView(Content.MembershipBasedBusiness)
                </MudStack>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.ExtraDigitMovement">
                <Loader Loaded="@(_edmEssentials.TeamMember != null)">
                    <TeamMemberPicker Description="Shareable For:" User="AppState?.User" @bind-SelectedTeamMember="_edmEssentials.TeamMember">
                        <MudSelect T="Content" Label="Capture Page" @bind-Value="_edmEssentials.Content" ToStringFunc="@(content => (UI.EnglishLocale[content]?.AppTitle ?? content.ToString()).Replace("<br/>", " "))" Variant="Variant.Outlined" Style="width:300px;">
                            @foreach (var content in new Content[] { Content.EDMPique, Content.EDMNeedMoreInfo })
                            {
                                <MudSelectItem Value="@content" />
                            }
                        </MudSelect>
                        @ContentView(_edmEssentials.Content)
                    </TeamMemberPicker>
                </Loader>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.FaithAndFinance">
                <MudStack>
                    <ShareableVideo Description="Faith & Finance"
                                    Duration="new(0, 2, 0)"
                                    Url="@(UI.EnglishLocale[Model.Content.FaithAndFinance]!.MinimalistUrl())"
                                    Tooltip="Shareable copied!"
                                    TextToCopy="@($"MWR Faith & Finance{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}(2min){Environment.NewLine}{UI.EnglishLocale[Model.Content.FaithAndFinance]!.MinimalistUrl()}")"
                                    ImageUrl="@Constants.GetImageUrl(Image.FaithAndFinance)"/>
                </MudStack>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.RealEstate">
                <MudText Align="Align.Center">Coming Soon!</MudText>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.Latino">
                <MudText Align="Align.Center">Coming Soon!</MudText>
            </MudTabPanel>
        </StrategyChooser>
    </Collapsable>
    <Collapsable Title="Miscellaneous" ExpandPrompt="Show">
        <MudStack Spacing="6">
            <MudCard Outlined="true">
                <MudCardContent>
                    <MudStack Spacing="3">
                        <MudSelect T="Content" Label="Explainers" @bind-Value="_selectedMiscellaneous" ToStringFunc="@(content => (UI.EnglishLocale[content]?.AppTitle ?? content.ToString()).Replace("<br/>", " "))" Variant="Variant.Outlined" Style="width:300px;">
                            @foreach (var content in new[] { Content.TeenCarPurchase, Content.MoneyChallengeFAQ, Content.ReduceMyTaxesExplainer, Content.EliminateMyDebtExplainer, Content.InvestmentsExplainer, Content.TrustsExplainer, Content.RevenueShareExplainer })
                            {
                                <MudSelectItem Value="@content" />
                            }
                        </MudSelect>
                        @ContentView(_selectedMiscellaneous)
                    </MudStack>
                </MudCardContent>
            </MudCard>
            <MudCard Outlined="true">
                <MudCardContent>
                    <MudStack Spacing="3">
                        <MudSelect T="Content" Label="Services" @bind-Value="_selectedService" ToStringFunc="@(content => (UI.EnglishLocale[content]?.AppTitle ?? content.ToString()).Replace("<br/>", " "))" Variant="Variant.Outlined" Style="width:300px;">
                            @foreach (var content in new[] { Content.GivBux, Content.GivBuxMerchant, Content.GivBuxCharity, Content.NextLevelStrategies, Content.Membership, Content.CreditRestoration, Content.StudentLoanDebtRelief, Content.HealthShare, Content.KeysToHomeOwnership, Content.PreciousMetals, Content.TrustMyAssets, Content.RealEstatePros, Content.ProtectMyAssets, Content.StructureMyLegacy })
                            {
                                <MudSelectItem Value="@content" />
                            }
                        </MudSelect>
                        @ContentView(_selectedService)
                    </MudStack>
                </MudCardContent>
            </MudCard>
            <Loader Loaded="@(_capturePage.TeamMember != null)">
                <TeamMemberPicker Description="Capture Page For:" @bind-SelectedTeamMember="_capturePage.TeamMember">
                    <MudSelect T="Content" Label="Capture Page" @bind-Value="_capturePage.Content" ToStringFunc="@(content => (UI.EnglishLocale[content]?.AppTitle ?? content.ToString()).Replace("<br/>", " "))" Variant="Variant.Outlined" Style="width:300px;">
                        @foreach (var content in Constants.OrderedContent)
                        {
                            <MudSelectItem Value="@content" />
                        }
                    </MudSelect>
                    <CapturePage Content="_capturePage.Content" TeamMember="_capturePage.TeamMember" />
                </TeamMemberPicker>
            </Loader>
        </MudStack>
    </Collapsable>
    <Collapsable Title="Marketing Directors" ExpandPrompt="Show">
        <MudStack>
            <Loader Loaded="@(_selectedTeamMemberMarketingDirector != null)">
                <TeamMemberPicker Description="Shareable For:" @bind-SelectedTeamMember="_selectedTeamMemberMarketingDirector">
                    <ShareableVideoMultilingual Description="Join MWR"
                                                Url="@Constants.JoinMakeWealthReal(_selectedTeamMemberMarketingDirector?.MemberId!, Language.English)"
                                              
                                                EnglishTextToCopy="@($"MWR Sign-up{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}{Constants.JoinMakeWealthReal(_selectedTeamMemberMarketingDirector?.MemberId!, Language.English)}{Constants.GetBusinessEnrollmentPromo(_selectedTeamMemberMarketingDirector?.MemberId!)}")"
                                                EnglishTooltip="English shareable copied!"
                                                EnglishImageUrl="@Constants.GetImageUrl(Image.MWRGivBuxLogo)"
                                                
                                                SpanishTextToCopy="@($"MWR Sign-up{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}{Constants.JoinMakeWealthReal(_selectedTeamMemberMarketingDirector?.MemberId!, Language.Spanish)}{Constants.GetBusinessEnrollmentPromo(_selectedTeamMemberMarketingDirector?.MemberId!)}")"
                                                SpanishTooltip="Español shareable copied!"
                                                SpanishImageUrl="@Constants.GetImageUrl(Image.MWRGivBuxLogo)" />
                </TeamMemberPicker>
            </Loader>
            <Loader Loaded="@(_selectedTeamMemberWebsite != null)">
                <TeamMemberPicker Description="Shareable For:" @bind-SelectedTeamMember="_selectedTeamMemberWebsite">
                    <ShareableVideoMultilingual Description="My Website"
                                               
                                                EnglishTextToCopy="@Constants.MarketingDirectorUrlEnglish(_selectedTeamMemberWebsite?.MemberId)"
                                                EnglishTooltip="English shareable copied!"
                                                EnglishImageUrl="@Constants.GetImageUrl(Image.MWRGivBuxLogo)"
                        
                                                SpanishTextToCopy="@Constants.MarketingDirectorUrlSpanish(_selectedTeamMemberWebsite?.MemberId)"
                                                SpanishTooltip="Español shareable copied!"
                                                SpanishImageUrl="@Constants.GetImageUrl(Image.MWRGivBuxLogo)" />
                </TeamMemberPicker>
            </Loader>
            <CardShareableMulti Description="Extra Digit Wealth Worksheet" Url="https://5f35ec78-8acd-4f4f-9b98-5439adb647ec.usrfiles.com/ugd/5f35ec_811dce03aa9c440fbf22bcb2c3d3a602.pdf">
                <Top>
                    <ShareableContent Title="For Prospects" Tooltip="Copied Shareable" ImageUrl="@Constants.GetImageUrl(Image.MWRGivBuxLogo)" TextToCopy="@($"Wealth Worksheet{Environment.NewLine}{Environment.NewLine}Print out before our meeting!{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}https://5f35ec78-8acd-4f4f-9b98-5439adb647ec.usrfiles.com/ugd/5f35ec_811dce03aa9c440fbf22bcb2c3d3a602.pdf")" />
                </Top>
                <Bottom>
                    <ShareableContent Title="For QMDs" Tooltip="Copied Shareable" ImageUrl="@Constants.GetImageUrl(Image.MWRGivBuxLogo)" TextToCopy="@($"Wealth Worksheet{Environment.NewLine}{Environment.NewLine}Print out before our meeting!{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}https://5f35ec78-8acd-4f4f-9b98-5439adb647ec.usrfiles.com/ugd/5f35ec_05b111199bee4d559058161fc236e7c8.pdf")" />
                </Bottom>
            </CardShareableMulti>
            <ShareableVideoMultilingual Description="Income Goal Simulator"
                                        Url="https://www.mwrfinancial.com/simulator/"

                                        EnglishTextToCopy="@($"MWR Income Goal Simulator{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}https://www.mwrfinancial.com/simulator/")"
                                        EnglishTooltip="English shareable copied!"
                                        EnglishImageUrl="@Constants.GetImageUrl(Image.MWRGivBuxLogo)"

                                        SpanishTextToCopy="@($"MWR Income Goal Simulator{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}https://www.mwrfinancial.com/es/simulator/")"
                                        SpanishTooltip="Español shareable copied!"
                                        SpanishImageUrl="@Constants.GetImageUrl(Image.MWRGivBuxLogo)" />
            <ShareableVideo Description="MWR Events"
                            Url="http://MakeWealthRealEvents.com"
                            Tooltip="Copied Shareable"
                            TextToCopy="http://MakeWealthRealEvents.com"/>
            <ShareableVideo Description="MWR Corporate Calendar"
                            Url="https://calendar.time.ly/zb6amxcw/posterboard"
                            Tooltip="Copied Shareable"
                            TextToCopy="@($"MWR Corporate Calendar{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}https://calendar.time.ly/zb6amxcw/posterboard")"/>
            <ShareableVideo Description="MWR Corporate Telegram Group"
                            Url="https://t.me/+gpFmytqMETExNDUx"
                            Tooltip="Copied Shareable"
                            TextToCopy="@($"MWR Corporate Telegram Group{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}https://t.me/+gpFmytqMETExNDUx")"/>
            <ShareableVideo Description=@Constants.AppShareable.Description
                            Tooltip=@Constants.AppShareable.English.Tooltip
                            TextToCopy=@Constants.AppShareable.English.Message
                            ImageUrl=@Constants.AppShareable.ImageUrl/>
            <ShareableVideo Description="@("Mega School App Install Instructions")"
                            Url="@Constants.AppInstallTutorialUrl"
                            Tooltip="Copied!"
                            TextToCopy="@($"Mega School App Install Instructions{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}{Constants.AppInstallTutorialUrl}")"
                            ImageUrl="@Constants.GetImageUrl(Image.AppScreenshot)"/>
        </MudStack>
    </Collapsable>
    <Collapsable Title="Team Links" ExpandPrompt="Show">
        <StrategyChooser Label="Team" DefaultStrategy="Strategy.Latino" Strategies="@StrategyChooser.AllStrategies.Except([Strategy.Corporate]).ToArray()">
            <MudTabPanel Tag="@Strategy.MegaSchool">
                <MudText Align="Align.Center">Coming Soon!</MudText>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.ExtraDigitMovement">
                <MudText Align="Align.Center">Coming Soon!</MudText>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.FaithAndFinance">
                <MudText Align="Align.Center">Coming Soon!</MudText>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.RealEstate">
                <MudText Align="Align.Center">Coming Soon!</MudText>
            </MudTabPanel>
            <MudTabPanel Tag="@Strategy.Latino">
                <ShareableVideo Description="Official Facebook Group"
                                Url="https://www.facebook.com/groups/frbeempoweringdiversitynationalteams"
                                Tooltip="Copied!"
                                TextToCopy="@($"FRBE Empowering Diversity National Teams Facebook Group{Environment.NewLine}{Constants.PointingDownEmoji}{Environment.NewLine}https://www.facebook.com/groups/frbeempoweringdiversitynationalteams")" />
            </MudTabPanel>
        </StrategyChooser>
    </Collapsable>
    <Collapsable Title="Images" ExpandPrompt="Show">
        <MudStack>
            <MudText Align="Align.Center">Tap Image to Download</MudText>
            <MudLink Href="@Constants.GetImageUrl(Image.MoneyChallengeLogo)" download>
                <MudImage Fluid="true" Src="@Constants.GetImageUrl(Image.MoneyChallengeLogo)" Alt="MWR 72-Hour Money Challenge" Class="rounded-lg" />
            </MudLink>
            <MudLink Href="@Constants.GetImageUrl(Image.MWRBanner)" download>
                <MudImage Fluid="true" Src="@Constants.GetImageUrl(Image.MWRBanner)" Alt="MWR Banner" Class="rounded-lg" />
            </MudLink>
            <MudLink Href="@Constants.GetImageUrl(Image.MembershipLogo)" download>
                <MudImage Fluid="true" Src="@Constants.GetImageUrl(Image.MembershipLogo)" Alt="MWR Membership Banner" Class="rounded-lg" />
            </MudLink>
            <MudLink Href="@Constants.GetImageUrl(Image.HealthShare)" download>
                <MudImage Fluid="true" Src="@Constants.GetImageUrl(Image.HealthShare)" Alt="MWR HealthShare" Class="rounded-lg" />
            </MudLink>
        </MudStack>
    </Collapsable>
</MudStack>
@code {
    private readonly ShareableViewModel _megaSchoolEssentials = new() { Content = Content.GivBux };
    private readonly ShareableViewModel _edmEssentials = new() { Content = Content.EDMPique };
    private readonly ShareableViewModel _capturePage = new() { Content = Content.GivBux };

    private TeamMember? _selectedTeamMemberMarketingDirector;
    private TeamMember? _selectedTeamMemberWebsite;
    private Content _selectedMiscellaneous = Content.TeenCarPurchase;
    private Content _selectedService = Content.GivBux;

    protected override void OnParametersSet()
    {
        _selectedTeamMemberMarketingDirector = AppState?.User;
        _selectedTeamMemberWebsite = AppState?.User;

        _megaSchoolEssentials.TeamMember = AppState?.User;
        _edmEssentials.TeamMember = AppState?.User;
        _capturePage.TeamMember = AppState?.User;
    }

    private RenderFragment ContentView(Content content) => __builder =>
    {
        var english = UI.EnglishLocale[content];
        var spanish = UI.SpanishLocale[content];

        if (spanish != null)
        {
            <ShareableVideoMultilingual Description="@english.AppTitle"
                                        Duration="@english.Duration"
                                        Url="@english.MinimalistUrl()"

                                        EnglishTextToCopy="@($"{Shareable.VideoShareable(english)}")"
                                        EnglishTooltip="Copied!"
                                        EnglishImageUrl="@Constants.GetImageUrl(english.Image ?? Image.MoneyChallengeLogo)"

                                        SpanishTextToCopy="@($"{Shareable.VideoShareable(spanish)}")"
                                        SpanishTooltip="Copied"
                                        SpanishImageUrl="@Constants.GetImageUrl(spanish.Image ?? Image.MoneyChallengeLogo)"/>
        }
        else
        {
            <ShareableVideo Description="@english.AppTitle"
                            Duration="@english.Duration"
                            Url="@english.MinimalistUrl()"
                            TextToCopy="@($"{Shareable.VideoShareable(english)}")"
                            Tooltip="Copied!"
            ImageUrl="@Constants.GetImageUrl(english.Image ?? Image.MoneyChallengeLogo)"/>
        }
    };

    private class ShareableViewModel
    {
        public Content Content { get; set; }
        public TeamMember? TeamMember { get; set; }
    }
}
